<html><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="utf-8" lang="utf-8">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
<title>å®‰å…¨ç±» - CodeIgniter ä¸­æ–‡æ‰‹å†Œ|ç”¨æˆ·æ‰‹å†Œ|ç”¨æˆ·æŒ‡å—|Wikiæ–‡æ¡£</title>
<link rel="shortcut icon" href="../../images/design/favicon.ico" tppabs="http://codeigniter.org.cn/images/design/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" type="text/css" media="all" href="../userguide.css" tppabs="http://codeigniter.org.cn/user_guide/userguide.css" />
<link rel="search" href="../../CodeIgniterSearch.xml" tppabs="http://codeigniter.org.cn/CodeIgniterSearch.xml" type="application/opensearchdescription+xml" title="CodeIgniter æœç´¢"/>
<link rel="canonical" href="security.html" tppabs="http://codeigniter.org.cn/user_guide/libraries/security.html" />
<script type="text/javascript" src="../nav/mootools.js-ver=20130324" tppabs="http://codeigniter.org.cn/user_guide/nav/mootools.js?ver=20130324"></script>
<script type="text/javascript" src="../nav/mootools-more.js-ver=20130324" tppabs="http://codeigniter.org.cn/user_guide/nav/mootools-more.js?ver=20130324"></script>
<script type="text/javascript" src="../nav/nav.js-ver=20130324" tppabs="http://codeigniter.org.cn/user_guide/nav/nav.js?ver=20130324"></script>
<script type="text/javascript" src="../nav/user_guide_menu.js-ver=20130324" tppabs="http://codeigniter.org.cn/user_guide/nav/user_guide_menu.js?ver=20130324"></script>
<meta name="robots" content="all" />
<meta name="author" content="ExpressionEngine Dev Team" />
<meta name="description" content="CodeIgniter ä¸­æ–‡æ‰‹å†Œ, CodeIgniter ç”¨æˆ·æŒ‡å—, CodeIgniter User Guide, Wiki æ–‡æ¡£" />
</head>
<body>
<!-- START NAVIGATION -->
<div id="nav">
  <div id="nav_inner">
    <script type="text/javascript">create_menu('http://codeigniter.org.cn/user_guide/');</script>
  </div>
</div>
<script type="text/javascript">_setNavigation();</script>
<div id="nav2"><a name="top"></a><a href="javascript:void(0);" onclick="myHeight.toggle();"><img src="../images/nav_toggle_darker.jpg" tppabs="http://codeigniter.org.cn/user_guide/images/nav_toggle_darker.jpg" width="154" height="43" border="0" title="åˆ‡æ¢ç›®å½•" alt="åˆ‡æ¢ç›®å½•" /></a></div>
<div id="masthead" class="clearfix">
    <div class="topbar-hd"><h1>CodeIgniter ç”¨æˆ·æŒ‡å— ç‰ˆæœ¬ 2.2.0</h1></div>
<div class="topbar-tip">ç¼–è¾‘æ–‡æ¡£ã€æŸ¥çœ‹è¿‘æœŸæ›´æ”¹è¯· <a href="javascript:if(confirm('http://codeigniter.org.cn/user_guide/auth/login  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÊÇ±»×Ô¶¯ÅÅ³ıËùÅÅ³ıµÄ¡£ (Äã²»Ò»¶¨ÒªÊ¹ÓÃ×Ô¶¯ÅÅ³ı£¬Çë²Î¿¼¡°ÏîÄ¿ÌØĞÔ¡±µÄ¡°ÍøÂçÀñ½Ú¡±¡£)  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://codeigniter.org.cn/user_guide/auth/login'" tppabs="http://codeigniter.org.cn/user_guide/auth/login">ç™»å½•</a> æˆ– <a href="javascript:if(confirm('http://codeigniter.org.cn/user_guide/auth/register  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÊÇ±»×Ô¶¯ÅÅ³ıËùÅÅ³ıµÄ¡£ (Äã²»Ò»¶¨ÒªÊ¹ÓÃ×Ô¶¯ÅÅ³ı£¬Çë²Î¿¼¡°ÏîÄ¿ÌØĞÔ¡±µÄ¡°ÍøÂçÀñ½Ú¡±¡£)  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://codeigniter.org.cn/user_guide/auth/register'" tppabs="http://codeigniter.org.cn/user_guide/auth/register">æ³¨å†Œ</a> ã€€<a href="javascript:if(confirm('http://codeigniter.org.cn/user_guide/auth/forgotten_password  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüÊÇ±»×Ô¶¯ÅÅ³ıËùÅÅ³ıµÄ¡£ (Äã²»Ò»¶¨ÒªÊ¹ÓÃ×Ô¶¯ÅÅ³ı£¬Çë²Î¿¼¡°ÏîÄ¿ÌØĞÔ¡±µÄ¡°ÍøÂçÀñ½Ú¡±¡£)  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://codeigniter.org.cn/user_guide/auth/forgotten_password'" tppabs="http://codeigniter.org.cn/user_guide/auth/forgotten_password">æ‰¾å›å¯†ç </a></div>      <div id="breadcrumb_right"><a href="../toc.html" tppabs="http://codeigniter.org.cn/user_guide/toc.html">ç›®å½•é¡µ</a></div>
</div>
<!-- END NAVIGATION -->
<!-- START BREADCRUMB -->
<table cellpadding="0" cellspacing="0" border="0" style="width:100%">
  <tr>
    <td id="breadcrumb">
        <a href="javascript:if(confirm('http://codeigniter.org.cn/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://codeigniter.org.cn/'" tppabs="http://codeigniter.org.cn/" target="_blank">CodeIgniter ä¸­å›½é¦–é¡µ</a>&nbsp;&#8250;&nbsp;
<a href="../index.html" tppabs="http://codeigniter.org.cn/user_guide/index.html">ç”¨æˆ·æŒ‡å—é¦–é¡µ</a>&nbsp;&#8250;&nbsp;å®‰å…¨ç±»    </td>
    <td id="searchbox">
        <form method="get" action="http://www.google.com.hk/search" target="google_window">
        <input type="hidden" name="client" value="pub-0176846097796333"></input>
        <input type="hidden" name="forid" value="1"></input>
        <input type="hidden" name="ie" value="UTF-8"></input>
        <input type="hidden" name="oe" value="UTF-8"></input>
        <input type="hidden" name="as_sitesearch" id="as_sitesearch" value="codeigniter.org.cn/user_guide/" />
        æœç´¢ç”¨æˆ·æŒ‡å—&nbsp;
        <input type="text" class="input" style="width:200px;" name="q" id="q" size="31" maxlength="255" value="" />
        &nbsp;
        <input type="submit" class="submit" name="sa" value="Go" />
      </form>
    </td>
  </tr>
</table>
<!-- END BREADCRUMB -->
<div style="clear:both;text-align:right;padding: 6px 40px 0 0;">
<a href="javascript:if(confirm('http://ellislab.com/codeigniter/user-guide/libraries/security.html  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://ellislab.com/codeigniter/user-guide/libraries/security.html'" tppabs="http://ellislab.com/codeigniter/user-guide/libraries/security.html" target="_blank">æŸ¥çœ‹åŸæ–‡</a>
</div>
<!--<br clear="all" />--><!-- START CONTENT -->
<div id="content">
<h1>å®‰å…¨ç±»</h1>

<p>å®‰å…¨ç±»åŒ…å«ä¸€äº›æ–¹æ³•ï¼Œèƒ½å¸®åŠ©æ‚¨åˆ›å»ºå®‰å…¨çš„åº”ç”¨ç¨‹åºï¼Œå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œå®‰å…¨æ–¹é¢çš„å¤„ç†.</p>

<h2>XSS è¿‡æ»¤</h2>

<p> CodeIgniter åŒ…å«äº†è·¨ç«™è„šæœ¬æ”»å‡»çš„é˜²å¾¡æœºåˆ¶ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åœ°å¯¹æ‰€æœ‰POSTä»¥åŠCOOKIEæ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œæˆ–è€…æ‚¨ä¹Ÿå¯ä»¥é’ˆå¯¹å•ä¸ªé¡¹ç›®æ¥è¿è¡Œå®ƒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒ <strong>ä¸ä¼š</strong>
å…¨å±€è¿è¡Œï¼Œå› ä¸ºè¿™æ ·ä¹Ÿéœ€è¦ä¸€äº›æ‰§è¡Œå¼€é”€ï¼Œå†µä¸”æ‚¨ä¹Ÿä¸ä¸€å®šåœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½ç”¨å¾—åˆ°å®ƒ.</p>

<p>XSSè¿‡æ»¤å™¨ä¼šæŸ¥æ‰¾é‚£äº›å¸¸è¢«ç”¨æ¥è§¦å‘JavaScriptæˆ–è€…å…¶ä»–ç±»å‹çš„ä¼å›¾åŠ«æŒcookieæˆ–è¿›è¡Œå…¶å®ƒæ¶æ„è¡Œä¸ºçš„ä»£ç . å¦‚æœå‘ç°ä»»ä½•ä¸å…è®¸çš„å†…å®¹ï¼Œå®ƒå°†æŠŠé‚£äº›å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦å®ä½“ï¼Œä»¥ç¡®ä¿å®‰å…¨.
</p>

<p>
æ³¨æ„: æ­¤å‡½æ•°åªåº”è¯¥ç”¨æ¥å¤„ç†é‚£äº›æäº¤è¿‡æ¥çš„æ•°æ®. å®ƒä¸é€‚åˆåœ¨å¸¸è§„è¿è¡Œæ—¶ä½¿ç”¨ï¼Œå› ä¸ºå®ƒæ‰§è¡Œæ—¶çš„å¼€é”€ä¹Ÿæ˜¯ä¸å®¹å¿½è§†çš„.</p>


<p>è¦ä½¿ç”¨XSSè¿‡æ»¤å™¨å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œè¯·ä½¿ç”¨æ­¤å‡½æ•°:</p>

<h2>$this-&gt;security-&gt;xss_clean()</h2>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å®ä¾‹:</p>

<code>$data = $this-&gt;security-&gt;xss_clean($data);</code>

<p>å¦‚æœä½ å¸Œæœ›è¿‡æ»¤å™¨èƒ½è‡ªåŠ¨è¿‡æ»¤æ‰€æœ‰è¢«è®¿é—®åˆ°çš„POSTæˆ–è€…COOKIEæ•°æ®ï¼Œè¯·æ‰“å¼€ä½ çš„ <kbd>application/config/config.php</kbd> æ–‡ä»¶ï¼Œè¿›è¡Œå¦‚ä¸‹è®¾ç½®å³å¯å¯ç”¨è‡ªåŠ¨è¿‡æ»¤:</p>

<code>$config['global_xss_filtering'] = TRUE;</code>

<p>è¯´æ˜: å¦‚æœä½ ä½¿ç”¨è¡¨å•éªŒè¯ç±»ï¼ŒåŒæ ·ä¹Ÿæœ‰XSSè¿‡æ»¤çš„é€‰é¡¹.</p>

<p>ç¬¬äºŒä¸ªå¯é€‰çš„å‚æ•°, <dfn>is_image</dfn>, å…è®¸æ­¤å‡½æ•°å¯¹å›¾ç‰‡è¿›è¡Œæ£€æµ‹ä»¥å‘ç°é‚£äº›æ½œåœ¨çš„ XSS æ”»å‡», è¿™å¯¹äºä¿è¯æ–‡ä»¶ä¸Šä¼ çš„å®‰å…¨éå¸¸æœ‰ç”¨. å½“æ­¤å‚æ•°è¢«è®¾ç½®ä¸º <dfn>TRUE</dfn> æ—¶, æ­¤å‡½æ•°çš„è¿”å›å€¼ä¸æ˜¯ä¸€ä¸ªä¿®æ”¹è¿‡çš„å­—ç¬¦ä¸²è€Œæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼, å¦‚æœå›¾ç‰‡æ˜¯å®‰å…¨çš„åˆ™è¿”å› TRUE, ç›¸å, å¦‚æœå›¾ç‰‡ä¸­åŒ…å«æœ‰æ½œåœ¨çš„ã€å¯èƒ½ä¼šè¢«æµè§ˆå™¨å°è¯•è¿è¡Œçš„æ¶æ„ä¿¡æ¯, å‡½æ•°å°†è¿”å›FALSE.</p>

<code>if ($this-&gt;security-&gt;xss_clean($file, TRUE) === FALSE)<br />
&#123;<br />
&nbsp;&nbsp;&nbsp;&nbsp;// file failed the XSS test<br />
&#125;</code>


<h2>$this-&gt;security-&gt;sanitize_filename()</h2>

<p>å½“æ¥å—ç”¨æˆ·æ‰€è¾“å…¥çš„æ–‡ä»¶åæ—¶, æœ€å¥½æ˜¯å¯¹å®ƒä»¬è¿›è¡Œä¸€ä¸‹â€œæ¶ˆæ¯’â€, è¿™æ ·èƒ½é¿å…ç›®å½•è¢«éå†ä»¥åŠå…¶å®ƒå®‰å…¨ç›¸å…³çš„é—®é¢˜. è¦å®Œæˆè¿™é¡¹å·¥ä½œ, è¯·ä½¿ç”¨å®‰å…¨ç±»ä¸­çš„  <dfn>sanitize_filename()</dfn> æ–¹æ³•. ä¸‹é¢æ˜¯ä¸€ä¸ªå®ä¾‹:</p>

<code>$filename = $this-&gt;security-&gt;sanitize_filename($this-&gt;input-&gt;post('filename'));</code>

<p>å¦‚æœä½ å…è®¸ç”¨æˆ·æ‰€è¾“å…¥çš„å†…å®¹ä¸­åŒ…å«æœ‰ç›¸å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ <kbd>file/in/some/approved/folder.txt</kbd>, ä½ å¯ä»¥æŠŠç¬¬äºŒä¸ªå¯é€‰å‚æ•° <samp>$relative_path</samp> è®¾ç½®ä¸ºTRUE.</p>

<code>$filename = $this-&gt;security-&gt;sanitize_filename($this-&gt;input-&gt;post('filename'), TRUE);</code>

<h2>è·¨ç«™è¯·æ±‚ä¼ªé€ (Cross-site request forgery,CSRF)</h2>

<p>æ‰“å¼€ä½ çš„ <kbd>application/config/config.php</kbd> æ–‡ä»¶ï¼Œè¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼Œå³å¯å¯ç”¨ csrf ä¿æŠ¤:</p>
<code>$config['csrf_protection'] = TRUE;</code>

<p>å¦‚æœä½ ä½¿ç”¨ <a href="../helpers/form_helper.html" tppabs="http://codeigniter.org.cn/user_guide/helpers/form_helper.html">è¡¨å•è¾…åŠ©å‡½æ•°</a>,  <var>form_open()</var> å‡½æ•°å°†ä¼šè‡ªåŠ¨åœ°åœ¨ä½ çš„è¡¨å•ä¸­æ’å…¥ä¸€ä¸ªéšè—çš„csrfå­—æ®µ.</p><p>&nbsp;</p>
<div id="Contributors">
ç¿»è¯‘è´¡çŒ®è€…:
Hex, yinzhili</div>
<div id="DocDate">
æœ€åä¿®æ”¹: 2011-02-13 08:21:49</div>
</div>
<!-- END CONTENT -->
<div id="footer">
  <p>
ä¸Šä¸€ä¸ªä¸»é¢˜:&nbsp;&nbsp;<a href="pagination.html" tppabs="http://codeigniter.org.cn/user_guide/libraries/pagination.html">åˆ†é¡µç±»</a>&nbsp;&nbsp;&middot;&nbsp;&nbsp;<a href="#top">é¡µé¦–</a>
&nbsp;&middot;&nbsp;&nbsp;<a href="../index.html" tppabs="http://codeigniter.org.cn/user_guide/index.html">ç”¨æˆ·æŒ‡å—é¦–é¡µ</a>&nbsp;&nbsp;&middot;&nbsp;&nbsp;ä¸‹ä¸€ä¸ªä¸»é¢˜:&nbsp;&nbsp;<a href="sessions.html" tppabs="http://codeigniter.org.cn/user_guide/libraries/sessions.html">Session ç±»</a>  </p>
  <p><a href="javascript:if(confirm('http://codeigniter.com/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://codeigniter.com/'" tppabs="http://codeigniter.com/">CodeIgniter</a> &nbsp;&middot;&nbsp; ç‰ˆæƒæ‰€æœ‰ &#169; 2006-2013 &nbsp;&middot;&nbsp; <a href="javascript:if(confirm('http://ellislab.com/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://ellislab.com/'" tppabs="http://ellislab.com/">Ellislab, Inc.</a></p>
  <p>ä¸­æ–‡åŒ–: <a href="javascript:if(confirm('http://codeigniter.org.cn/  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://codeigniter.org.cn/'" tppabs="http://codeigniter.org.cn/">CodeIgniter ä¸­å›½</a> &nbsp;&middot;&nbsp; åˆ¶ä½œ: Hex &nbsp;&middot;&nbsp; ç‰ˆæœ¬: 1.30 &nbsp;&middot;&nbsp; é¸£è°¢: å­éé±¼</p>
</div>
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-272152-3']);
_gaq.push(['_addOrganic', 'baidu', 'word']);
_gaq.push(['_addOrganic', 'soso', 'w']);
_gaq.push(['_addOrganic', '3721', 'name']);
_gaq.push(['_addOrganic', 'yodao', 'q']);
_gaq.push(['_addOrganic', 'vnet', 'kw']);
_gaq.push(['_addOrganic', 'sogou', 'query']);
_gaq.push(['_addIgnoredOrganic', 'codeigniter.org.cn']);
_gaq.push(['_trackPageview']);
(function() {
    var ga = document.createElement('script');
    ga.src = (('https:' == document.location.protocol) ? 'https://ssl' : 'http://www/') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
})();
</script>
<div style="display:none"><script language="javascript" type="text/javascript" src="../../../js.users.51.la/3289908.js" tppabs="http://js.users.51.la/3289908.js"></script>
<noscript><a href="javascript:if(confirm('http://www.51.la/?3289908  \n\nÎÄ¼ş²¢Î´ÒÀ Teleport Pro È¡»Ø£¬ÒòÎª ËüµÄÓò»òÂ·¾¶³¬¹ı¿ªÊ¼ÍøÖ·ÖĞÉèÖÃµÄ·¶Î§¡£  \n\nÄãÒª´Ó·şÎñÆ÷ÉÏ´ò¿ªËüÂğ£¿'))window.location='http://www.51.la/?3289908'" tppabs="http://www.51.la/?3289908" target="_blank"><img alt="&#x6211;&#x8981;&#x5566;&#x514D;&#x8D39;&#x7EDF;&#x8BA1;" src="../../../web.51.la/go.asp-svid=5&id=3289908&style=-1&vpage=http---codeigniter.org.cn-user_guide-index.html&60478.8.gif" tppabs="http://img.users.51.la/3289908.asp" style="border:none" /></a></noscript></div>
</body>
</html>